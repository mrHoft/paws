(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const Te="modulepreload",Ae=function(r,e){return new URL(r,e).href},de={},Ne=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){let p=function(d){return Promise.all(d.map(g=>Promise.resolve(g).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};const o=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");n=p(t.map(d=>{if(d=Ae(d,s),d in de)return;de[d]=!0;const g=d.endsWith(".css"),w=g?'[rel="stylesheet"]':"";if(s)for(let T=o.length-1;T>=0;T--){const k=o[T];if(k.href===d&&(!g||k.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${w}`))return;const _=document.createElement("link");if(_.rel=g?"stylesheet":Te,g||(_.as="script"),_.crossOrigin="",_.href=d,f&&_.setAttribute("nonce",f),document.head.appendChild(_),g)return new Promise((T,k)=>{_.addEventListener("load",T),_.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return n.then(o=>{for(const u of o||[])u.status==="rejected"&&i(u.reason);return e().catch(i)})},j={GCExt:249,COMMENT:254,APPExt:255,UNKNOWN:1,IMAGE:44,EOF:59},Fe=function(){let r,e;const t=[0,4,2,1],s=[8,8,4,2];let n,i,o,u;class f{data;pos;len;constructor(c){this.data=new Uint8ClampedArray(c),this.pos=0,this.len=this.data.length}getString(c){let h="";for(;c--;)h+=String.fromCharCode(this.data[this.pos++]);return h}readSubBlocks(){let c,h,b="";do for(h=c=this.data[this.pos++];h--;)b+=String.fromCharCode(this.data[this.pos++]);while(c!==0&&this.pos<this.len);return b}readSubBlocksB(){let c,h;const b=[];do for(h=c=this.data[this.pos++];h--;)b.push(this.data[this.pos++]);while(c!==0&&this.pos<this.len);return b}}function p(l,c){let h=0,b=0,y=[];const O=1<<l,S=O+1;let A=l+1,Q=!1,L,N=0;for(;!Q;){L=N,N=0;for(let E=0;E<A;E++)c[h>>3]&1<<(h&7)&&(N|=1<<E),h++;if(N===O){y=[],A=l+1;for(let E=0;E<O;E++)y[E]=[E];y[O]=[],y[S]=[]}else{if(N===S){Q=!0;return}N>=y.length?y.push(y[L].concat(y[L][0])):L!==O&&y.push(y[L].concat(y[N][0]));const E=y[N],H=E.length;for(let ie=0;ie<H;ie++)u[b++]=E[ie];y.length===1<<A&&A<12&&A++}}}function d(l){const c=[];for(let h=0;h<l;h++)c.push([e.data[e.pos++],e.data[e.pos++],e.data[e.pos++]]);return c}function g(){e.pos+=6,a.width=e.data[e.pos++]+(e.data[e.pos++]<<8),a.height=e.data[e.pos++]+(e.data[e.pos++]<<8);const l=e.data[e.pos++];a.colorRes=(l&112)>>4,a.globalColorCount=1<<(l&7)+1,a.bgColorIndex=e.data[e.pos++],e.pos++,l&128&&(a.globalColorTable=d(a.globalColorCount)),setTimeout(G,0)}function w(){e.pos+=1,e.getString(8)==="NETSCAPE"?e.pos+=8:(e.pos+=3,e.readSubBlocks())}function _(){e.pos++;const l=e.data[e.pos++];a.disposalMethod=(l&28)>>2,a.transparencyGiven=!!(l&1),a.delayTime=e.data[e.pos++]+(e.data[e.pos++]<<8),a.transparencyIndex=e.data[e.pos++],e.pos++}function T(){const l=b=>{const y=o/b;let O=0;n!==o&&(i=new Uint8Array(o),n=o);for(let S=0;S<4;S++)for(let A=t[S];A<y;A+=s[S])i.set(u.subarray(O,O+b),A*b),O+=b},c={disposalMethod:a.disposalMethod,time:a.length,delay:a.delayTime*10,leftPos:0,topPos:0,width:0,height:0,localColorTableFlag:!1,interlaced:!1,image:document.createElement("canvas")};a.frames.push(c),a.length+=c.delay,a.transparencyGiven&&(c.transparencyIndex=a.transparencyIndex),c.leftPos=e.data[e.pos++]+(e.data[e.pos++]<<8),c.topPos=e.data[e.pos++]+(e.data[e.pos++]<<8),c.width=e.data[e.pos++]+(e.data[e.pos++]<<8),c.height=e.data[e.pos++]+(e.data[e.pos++]<<8);const h=e.data[e.pos++];c.localColorTableFlag=!!(h&128),c.localColorTableFlag&&(c.localColorTable=d(1<<(h&7)+1)),o!==c.width*c.height&&(u=new Uint8Array(c.width*c.height),o=c.width*c.height),p(e.data[e.pos++],e.readSubBlocksB()),h&64?(c.interlaced=!0,l(c.width)):c.interlaced=!1,k(c)}function k(l){l.image.width=a.width,l.image.height=a.height;const c=l.image.getContext("2d");l.image.ctx=c;const h=l.localColorTableFlag?l.localColorTable:a.globalColorTable;a.lastFrame===null&&(a.lastFrame=l);const b=a.lastFrame.disposalMethod===2||a.lastFrame.disposalMethod===3;b||c.drawImage(a.lastFrame.image,0,0,a.width,a.height);const y=c.getImageData(l.leftPos,l.topPos,l.width,l.height),O=l.transparencyIndex,S=y.data,A=l.interlaced?i:u,Q=A.length;let L=0;for(let N=0;N<Q;N++){const E=A[N],H=h[E];O!==E?(S[L++]=H[0],S[L++]=H[1],S[L++]=H[2],S[L++]=255):(b&&(S[L+3]=0),L+=4)}c.putImageData(y,l.leftPos,l.topPos),a.lastFrame=l,!a.waitTillDone&&typeof a.onload=="function"&&Y()}function F(){a.loading=!1,a.frameCount=a.frames.length,a.lastFrame=null,e=void 0,a.complete=!0,a.disposalMethod=void 0,a.transparencyGiven=void 0,a.delayTime=void 0,a.transparencyIndex=void 0,a.waitTillDone=void 0,u=void 0,i=void 0,o=void 0,i=void 0,a.currentFrame=0,a.frames.length>0&&(a.image=a.frames[0].image),Y(),typeof a.onloadall=="function"&&a.onloadall.bind(a)({type:"loadall",obj:a}),a.playOnLoad&&a.play()}function P(){F(),typeof a.cancelCallback=="function"&&a.cancelCallback.bind(a)({type:"canceled",obj:a})}function M(){const l=e.data[e.pos++];l===j.GCExt?_():l===j.COMMENT?a.comment+=e.readSubBlocks():l===j.APPExt?w():(l===j.UNKNOWN&&(e.pos+=13),e.readSubBlocks())}function G(){if(a.cancel===!0){P();return}const l=e.data[e.pos++];if(l===j.IMAGE){if(T(),a.firstFrameOnly){F();return}}else if(l===j.EOF){F();return}else M();typeof a.onprogress=="function"&&a.onprogress({bytesRead:e.pos,totalBytes:e.data.length,frame:a.frames.length}),setTimeout(G,0)}function J(l){return a.complete?!1:(a.cancelCallback=l,a.cancel=!0,!0)}function U(l){typeof a.onerror=="function"&&a.onerror.bind(a)({type:l,obj:a}),a.onload=a.onerror=null,a.loading=!1}function Y(){a.currentFrame=0,typeof a.onload=="function"&&a.onload.bind(a)({type:"load",obj:a}),a.onerror=a.onload=null}function we(l){e=new f(l),g()}function Ee(l){const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onload=function(h){if(h.target){const{status:b}=h.target;b===404?U("File not found"):b>=200&&b<300?we(c.response):U("Loading error : "+b)}},c.open("GET",l,!0),c.send(),c.onerror=()=>U("File error"),a.src=l,a.loading=!0}function Ce(){a.playing||(a.paused=!1,a.playing=!0,Z())}function ke(){a.paused=!0,a.playing=!1,clearTimeout(r)}function Se(){a.paused||!a.playing?a.play():a.pause()}function Le(l){clearTimeout(r),a.currentFrame=l%a.frames.length,a.playing?Z():a.image=a.frames[a.currentFrame].image}function xe(l){clearTimeout(r),l<0&&(l=0),l*=1e3,l%=a.length;let c=0;for(;l>a.frames[c].time+a.frames[c].delay&&c<a.frames.length;)c+=1;a.currentFrame=c,a.playing?Z():a.image=a.frames[a.currentFrame].image}function Z(){let l,c;if(a.playSpeed===0){a.pause();return}else a.playSpeed<0?(a.currentFrame-=1,a.currentFrame<0&&(a.currentFrame=a.frames.length-1),c=a.currentFrame,c-=1,c<0&&(c=a.frames.length-1),l=-a.frames[c].delay*1/a.playSpeed):(a.currentFrame+=1,a.currentFrame%=a.frames.length,l=a.frames[a.currentFrame].delay*1/a.playSpeed),a.image=a.frames[a.currentFrame].image,r=setTimeout(Z,l)}const a={onload:null,onerror:null,onprogress:null,onloadall:null,paused:!1,playing:!1,waitTillDone:!0,loading:!1,firstFrameOnly:!1,width:null,height:null,frames:[],comment:"",length:0,currentFrame:0,frameCount:0,playSpeed:1,lastFrame:null,image:null,playOnLoad:!0,colorRes:0,globalColorCount:0,bgColorIndex:0,disposalMethod:0,transparencyGiven:!1,delayTime:0,transparencyIndex:0,complete:!1,load:Ee,cancelLoad:J,play:Ce,pause:ke,seek:xe,seekFrame:Le,togglePlay:Se};return a},fe=r=>r!==Object(r);function Me(r,e,t){if(fe(r))return r;if(typeof e!="string"||e=="")throw new Error("Path must be string");let s=r;const n=e.split("."),i=n.pop();return n.forEach(o=>{s[o]||(s[o]={}),s=s[o]}),s[i]=t,r}function Jt(r,e){if(fe(r))return r;if(typeof e!="string"||e=="")throw new Error("Path must be string");let t=r;const s=e.split("."),n=s.pop();return s.forEach(i=>{t[i]||(t[i]={}),t=t[i]}),t[n]}const Oe=".",oe={cat:"sprites/cat-ginger.gif",cactus1:"sprites/cactus1.png",cactus2:"sprites/cactus2.png",puddle:"sprites/water-puddle.png",boulder:"sprites/boulder.png",gnome:"sprites/garden-gnome.png",flowerpot:"sprites/flowerpot.png",bucket:"sprites/bucket.png",bird:"sprites/bird-yellow.gif",butterfly:"sprites/butterfly-orange.gif",grasshopper:"sprites/grasshopper.gif",mouse:"sprites/mouse-brown.gif","mountains.layer1":"scene/mountains/layer1.png","mountains.layer2":"scene/mountains/layer2.png","mountains.layer3":"scene/mountains/layer3.png","cliff.layer1":"scene/cliff/layer1.png","cliff.layer2":"scene/cliff/layer2.png","cliff.layer3":"scene/cliff/layer3.png","autumn.layer1":"scene/autumn/layer1.png","autumn.layer2":"scene/autumn/layer2.png","autumn.layer3":"scene/autumn/layer3.png","desert.layer1":"scene/desert/layer1.png","desert.layer2":"scene/desert/layer2.png","desert.layer3":"scene/desert/layer3.png","lake.layer1":"scene/lake/layer1.png","lake.layer2":"scene/lake/layer2.png","lake.layer3":"scene/lake/layer3.png","jungle.layer1":"scene/jungle/layer1.png","jungle.layer2":"scene/jungle/layer2.png","jungle.layer3":"scene/jungle/layer3.png","forest.layer1":"scene/forest/layer1.png","forest.layer2":"scene/forest/layer2.png","forest.layer3":"scene/forest/layer3.png"};class C{total;progress=0;current=0;static __instance;static _initialized=!1;static _progressCallback;static _errorCallback;sprite={};constructor(){this.total=Object.keys(oe).length,this.initialize()}countOne=()=>{this.current+=1,this.progress=Math.floor(this.current/this.total*100),C._progressCallback(this.progress)};loadGif=(e,t)=>{setTimeout(()=>{const s=Fe();return s.onerror=function(n){console.log("Gif loading error "+n.type),C._errorCallback&&C._errorCallback(`Img loading error: ${n.type}`)},s.onloadall=()=>{this.countOne()},s.load(t),this.sprite[e]=s,s},0)};loadImg=(e,t)=>{const s=document.createElement("img");return s.src=t,s.onload=()=>{this.countOne()},s.onerror=function(n){console.log("Img loading error:",n),C._errorCallback&&C._errorCallback(`Img loading error: ${e}`)},Me(this.sprite,e,s),s};initialize=()=>{if(!C._initialized){const e=Object.keys(oe);for(const t of e){const s=oe[t],n=s.split(".").pop(),i=`${Oe}/${s}`;switch(n){case"gif":{this.loadGif(t,i);break}case"png":{this.loadImg(t,i);break}}}}};static get(e,t){return C.__instance?C.__instance:(e&&(C._progressCallback=e),t&&(C._errorCallback=t),C.__instance=new C)}}const z={width:1280,height:576},re={cat:{width:252,height:144}},Pe={version:"alpha.0.2.12",scorePerLevel:1e3,catchRange:24,actionPositionVertical:Math.floor(z.height*.88),trajectoryStep:3,jumpHeightMin:Math.floor(re.cat.height/1.5),jumpHeightMax:re.cat.height*2.25,defaultCatX:Math.floor(z.width/3),get defaultCatY(){return this.actionPositionVertical+re.cat.height*.05},defaultTargetX:z.width/2,animalPositionDelta:z.width/8,get defaultTargetY(){return this.actionPositionVertical},defaultTargetHeight:128,defaultRunAwayDelay:8e3},ne=["mouse","grasshopper","butterfly","bird"],Ie=["cactus1","cactus2","puddle","boulder","flowerpot","gnome","bucket"],R=["autumn","cliff","desert","forest","jungle","lake","mountains"],De={autumn:["mouse","bird","puddle","flowerpot","boulder"],cliff:["butterfly","grasshopper","flowerpot","boulder","gnome"],desert:["butterfly","mouse","cactus1","cactus2"],forest:["butterfly","grasshopper","bird","puddle","boulder"],jungle:["butterfly","grasshopper","bird","puddle","boulder","cactus1"],lake:["mouse","bird","puddle","flowerpot","gnome"],mountains:["mouse","grasshopper","puddle","flowerpot","gnome"],default:[...ne,...Ie]},Yt={none:{success:0,fail:0},butterfly:{success:10,fail:0},grasshopper:{success:10,fail:0},frog:{success:10,fail:-5},bird:{success:10,fail:-5},mouse:{success:10,fail:-10},puddle:{success:5,fail:-5},boulder:{success:5,fail:-5},flowerpot:{success:10,fail:-10},bucket:{success:5,fail:-10},gnome:{success:5,fail:-10},cactus1:{success:5,fail:-20},cactus2:{success:5,fail:-20}},$e="_weather_layer_1c903_1",Ge="_weather__leaf_1c903_12",he={weather_layer:$e,weather__leaf:Ge},Re="./images/leaf_brown.svg";class Ve{container;leaves=[];isDestroyed=!1;constructor(e={}){const{leafCount:t=3}=e;this.container=document.createElement("div"),this.container.className=he.weather_layer;for(let s=0;s<t;s++)this.addLeaf()}createWeatherLeaf(){const e=document.createElement("img");return e.src=Re,e.className=he.weather__leaf,e.animationData={horizontalSpeed:Math.floor(1e4+Math.random()*1e4),rotationSpeed:Math.floor((Math.random()*3+2)*10)/10,swirlFrequency:.5+Math.random()*1,swirlAmplitude:10+Math.random()*20},e}addLeaf(){const e=this.createWeatherLeaf();this.container.appendChild(e),this.leaves.push(e),this.setRandomLeafProperties(e),this.animateLeaf(e)}setRandomLeafProperties(e){const t=90-Math.pow(Math.random(),2)*85;e.style.top=`${t}%`,e.style.left="0";const s=30+Math.random()*15;e.style.width=e.style.height=`${s}px`}animateLeaf(e){if(this.isDestroyed)return;const t=e.animationData,s=[{transform:"translateX(0) rotate(0deg)"},{transform:`translateX(100vw) rotate(${-t.rotationSpeed*360}deg)`}],n={duration:t.horizontalSpeed,iterations:1,fill:"forwards"};e.animation=e.animate(s,n),e.animation.onfinish=()=>{this.isDestroyed||(this.setRandomLeafProperties(e),this.animateLeaf(e))}}addLeaves(e=1){if(!this.isDestroyed)for(let t=0;t<e;t++)this.addLeaf()}removeLeaves(){this.isDestroyed||(this.leaves.forEach(e=>{e.animation&&e.animation.cancel(),e.remove()}),this.leaves=[])}destroy(){this.isDestroyed||(this.removeLeaves(),this.container.remove(),this.isDestroyed=!0)}get leafCount(){return this.leaves.length}pause(e){e?this.leaves.forEach(t=>{t.animation&&t.animation.pause()}):this.leaves.forEach(t=>{t.animation&&t.animation.play()})}get element(){return this.container}}const je="_button_1usnt_1",Be="_circle_1usnt_11",ze="_inner_1usnt_23",qe="_btn_icon_1usnt_40",Ue="_btn_close_1usnt_61",K={button:je,circle:Be,inner:ze,btn_icon:qe,btn_close:Ue},q=({src:r})=>{const e=document.createElement("div");e.className=K.button;const t=document.createElement("div");t.className=K.circle;const s=document.createElement("div");s.className=K.inner;const n=document.createElement("img");return n.src=r,s.append(n),e.append(t,s),e},ge={butterfly:"./spoil/butterfly.svg",grasshopper:"./spoil/frog.svg",frog:"./spoil/frog.svg",mouse:"./spoil/mouse.svg",bird:"./spoil/bird.svg"},m={check:"./icons/check.svg",close:"./icons/close.svg",resume:"./icons/play.svg",restart:"./icons/restart.svg",settings:"./icons/settings.svg",menu:"./icons/menu.svg",play:"./icons/play.svg",about:"./icons/about.svg",fullscreen:"./icons/fullscreen.svg",fullscreenExit:"./icons/fullscreen-exit.svg",pause:"./icons/pause.svg",soundOn:"./icons/sound-on.svg",soundOff:"./icons/sound-off.svg",sound:"./icons/sound.svg",music:"./icons/music.svg",fps:"./icons/fps.svg",globe:"./icons/globe.svg",en:"./flag/en.svg",ru:"./flag/ru.svg",de:"./flag/de.svg",tr:"./flag/tr.svg",fr:"./flag/fr.svg"},be=["en","ru","tr","de","fr"],le={en:{start:"Start",restart:"Restart",pause:"Pause",settings:"Settings",about:"About",level:"Level",score:"Score",combo:"Combo",confirmation:"Confirmation",confirmationDefault:"Are you sure?",restartDesc:"This will reset all your progress. Are you sure want to restart?",newGame:"Hold space/tap to jump",firstAnimal:"Need to jump on target",firstBarrier:"Need to jump over the target",firstTimeout:"The animal can run away"},ru:{start:"Старт",restart:"Заново",pause:"Пауза",settings:"Настройки",about:"О программе",level:"Уровень",score:"Счёт",combo:"Комбо",confirmation:"Подтверждение",confirmationDefault:"Вы уверены?",restartDesc:"Это сбросит весь ваш прогресс. Вы точно хотите начать заново?",newGame:"Удерживайте пробел/тап для прыжка",firstAnimal:"Для поимки нужно прыгать на цель",firstBarrier:"Через препятствие нужно перепрыгивать",firstTimeout:"Животное может убежать"},tr:{start:"Başlat",restart:"Yeniden Başlat",pause:"Duraklat",settings:"Ayarlar",about:"Hakkında",level:"Seviye",score:"Skor",combo:"Kombo",confirmation:"Onay",confirmationDefault:"Emin misiniz?",restartDesc:"Bu, tüm ilerlemenizi sıfırlayacak. Yeniden başlatmak istediğinizden emin misiniz?",newGame:"Zıplamak için boşluk tuşunu basılı tutun/dokunun",firstAnimal:"Hedefin üzerine zıplanmalı",firstBarrier:"Hedefin üzerinden atlanmalı",firstTimeout:"Hayvan kaçabilir"},de:{start:"Start",restart:"Neustart",pause:"Pause",settings:"Einstellungen",about:"Über",level:"Level",score:"Punkte",combo:"Combo",confirmation:"Bestätigung",confirmationDefault:"Sind Sie sicher?",restartDesc:"Dies wird Ihren gesamten Fortschritt zurücksetzen. Möchten Sie wirklich neu starten?",newGame:"Leertaste gedrückt halten/tippen zum Springen",firstAnimal:"Muss auf das Ziel springen",firstBarrier:"Muss über das Ziel springen",firstTimeout:"Das Tier kann weglaufen"},fr:{start:"Commencer",restart:"Recommencer",pause:"Pause",settings:"Paramètres",about:"À propos",level:"Niveau",score:"Score",combo:"Combo",confirmation:"Confirmation",confirmationDefault:"Êtes-vous sûr?",restartDesc:"Cela réinitialisera toute votre progression. Êtes-vous sûr de vouloir recommencer?",newGame:"Maintenez espace/touchez pour sauter",firstAnimal:"Doit sauter sur la cible",firstBarrier:"Doit sauter par-dessus la cible",firstTimeout:"L'animal peut s'échapper"}},me=r=>be.includes(r);class I{static _instance;lang="en";field={};constructor(e){if(I._instance)return I._instance;I._instance=this,e&&me(e)&&(this.lang=e)}register=(e,t)=>{this.field[e]?this.field[e].push(t):this.field[e]=[t],this.set(e)};set language(e){const t=this.lang;me(e)&&(this.lang=e),t!==this.lang&&this.emit()}get language(){return this.lang}get=e=>{const t=le[this.lang][e]||"";return t||console.warn("No localization for",e),t};set=e=>{const t=this.field[e],s=le[this.lang][e];t&&s?t.forEach(n=>n.textContent=s):s||console.warn("No localization for",e)};emit=()=>{const e=le[this.lang];for(const t of Object.keys(e))this.set(t)}}const ae=({src:r})=>{const e=document.createElement("div"),t=document.createElement("img");return t.src=r,t.width=t.height=40,e.append(t),e.className=K.btn_icon,e},te=()=>{const r=document.createElement("div");r.className=K.btn_close;const e=document.createElement("img");return e.src=m.close,r.append(e),r},He="_confirmation_layer_z3lgq_1",We="_confirmation__inner_z3lgq_14",Ke="_btns_z3lgq_35",Xe="_bounce_z3lgq_40",B={confirmation_layer:He,confirmation__inner:We,btns:Ke,bounce:Xe};class Je{loc;container;inner;message;acceptCallback;constructor(){this.loc=new I,this.container=document.createElement("div"),this.container.className=B.confirmation_layer;const e=document.createElement("h3");this.loc.register("confirmation",e),this.inner=document.createElement("div"),this.inner.className=B.confirmation__inner;const t=te();t.addEventListener("click",()=>{this.container.setAttribute("style","display: none;")}),this.message=document.createElement("p");const s=document.createElement("div");s.className=B.btns;const n=q({src:m.check}),i=q({src:m.close});s.append(n,i),this.inner.append(e,this.message,s,t),this.container.append(this.inner),this.container.addEventListener("click",o=>{const{target:u,currentTarget:f}=o;u===f&&(o.preventDefault(),this.handleCancel())}),n.addEventListener("click",this.handleAccept),i.addEventListener("click",this.handleCancel)}show=({text:e,acceptCallback:t})=>{this.acceptCallback=t,this.message.innerText=e||this.loc.get("confirmationDefault"),this.container.setAttribute("style","display: flex;"),this.inner.classList.add(B.bounce)};handleAccept=()=>{this.container.setAttribute("style","display: none;"),this.inner.classList.remove(B.bounce),this.acceptCallback&&this.acceptCallback()};handleCancel=()=>{this.container.setAttribute("style","display: none;"),this.inner.classList.remove(B.bounce)};get element(){return this.container}}const Ye="_pause_layer_cevix_1",Ze="_pause__header_cevix_14",Qe="_pause__btns_cevix_25",et="_bounce_cevix_30",W={pause_layer:Ye,pause__header:Ze,pause__btns:Qe,bounce:et};class tt{loc;confirm;container;inner;pause;restart;menu;constructor({pause:e,restart:t,menu:s,confirm:n}){this.loc=new I,this.confirm=n,this.container=document.createElement("div"),this.container.className=W.pause_layer,this.pause=e,this.restart=t,this.menu=s,this.inner=document.createElement("div"),this.inner.className=W.pause__inner;const i=document.createElement("h2");i.className=W.pause__header,this.loc.register("pause",i);const o=document.createElement("div");o.className=W.pause__btns;const u=q({src:m.resume});u.addEventListener("click",this.handleResume);const f=q({src:m.restart});f.addEventListener("click",this.handleRestart);const p=q({src:m.menu});p.addEventListener("click",this.handleMenu),o.append(u,f,p),this.inner.append(i,o),this.container.append(this.inner),this.container.addEventListener("click",d=>{const{target:g,currentTarget:w}=d;g===w&&(d.preventDefault(),this.handleResume())})}show=e=>{this.container.setAttribute("style",e?"display: flex;":"display: none;"),this.inner.classList.toggle(W.bounce,e)};handleResume=()=>{this.show(!1),this.pause(!1)};handleRestart=()=>{this.confirm.show({text:this.loc.get("restartDesc"),acceptCallback:()=>{this.show(!1),this.restart()}})};handleMenu=()=>{this.show(!1),this.menu()};get element(){return this.container}}const se={catch:{url:"./audio/catch.ogg",type:"single"},combo:{url:"./audio/combo.ogg",type:"single"},impact:{url:"./audio/impact.ogg",type:"single"},jump:{url:"./audio/jump.ogg",type:"single"}},ye=[{name:"Mountains",url:"./audio/mountains.mp3"}],pe=Object.keys(se).length+ye.length*2;class V{static _instance;_sound={volume:.5,muted:!1};_music={volume:.5,muted:!0};sounds={};tracks=[];loaded=0;ready=0;pending=-1;playing=null;startPlayCallback;exceptionCallback;readyCallback;constructor(e={}){if(e.sound&&(this._sound=e.sound),e.music&&(this._music=e.music),V._instance)return V._instance;V._instance=this,Object.keys(se).forEach(t=>{const{url:s,type:n}=se[t];this.getSound(s,t,n)}),ye.forEach(t=>this.getSound(t.url,t.name,"music")),this.handleCanplay=this.handleCanplay.bind(this),this.handleEnded=this.handleEnded.bind(this)}set musicVolume(e){this._music.volume=e,this._music.muted=e===0,this.playing&&(this.playing.audio.volume=e)}set musicMute(e){this._music.muted=e,this.playing?this.playing.audio.muted=e:this.play(0,!0)}set mute(e){this._sound.muted=e,this.musicMute=e}get muted(){return this._sound.muted||this._music.muted}get music(){return this._music}get sound(){return this._sound}set soundVolume(e){this._sound.muted=e===0,this._sound.volume=e}play(e,t){if(this._music.muted||e===-1)return;const s=this.tracks[e];if(!s||!s.ready){this.pending=e;return}const n=s.audio;n.volume=this._music.volume,n.muted=this._music.muted,n.play().then(()=>{n.addEventListener("ended",this.handleEnded(t)),this.playing={track:e,audio:n},this.startPlayCallback&&this.startPlayCallback(s.name)}).catch(i=>{i.name==="NotAllowedError"?(this.pending=e,this.waitForUserInteraction().then(()=>{this.play(this.pending,!0)})):(this._music.muted=!0,this.exceptionCallback&&this.exceptionCallback(i instanceof Error?i.message:i.toString()))})}pause=()=>{this.playing?.audio.pause()};use(e){if(!this._sound.muted){if(!Object.keys(se).includes(e)){console.warn(`No sound: ${e}`);return}for(let t=0;t<10;t+=1){const s=this.sounds[e][t];if(s.currentTime===0||s.ended){s.volume=this._sound.volume,s.play().catch(n=>console.error(n));return}}}}getSound(e,t,s){const n=this,i=new Request(e,{method:"GET",headers:{"Accept-Ranges":"1000000000"},referrerPolicy:"no-referrer"});fetch(i).then(async function(o){const u=await o.blob(),f=window.URL.createObjectURL(u);if(n.loaded+=1,n.ready=~~(n.loaded/pe*100),s==="music"){const p=new Audio;p.src=f,p.musicInfo={name:t,track:n.tracks.length},p.addEventListener("canplay",n.handleCanplay),n.tracks.push({name:t,audio:p,ready:!1})}else n.sounds[t]=Array.from({length:s==="multiple"?10:1},()=>{const p=new Audio;return p.src=f,p});n.readyCallback&&n.readyCallback(n.ready,t)})}handleCanplay(e){const t=e.target;if(t){t.removeEventListener("canplay",this.handleCanplay);const{name:s,track:n}=t.musicInfo;this.loaded+=1,this.ready=~~(this.loaded/pe*100),this.tracks[n].ready=!0,this.pending===n&&(this.play(this.pending,!0),this.pending=-1),this.readyCallback&&this.readyCallback(this.ready,s)}}handleEnded=e=>()=>{if(!this.playing)return;let t=(this.playing.track??0)+1;t>=this.tracks.length&&(t=0),this.playing=null,e&&this.play(t,!0)};waitForUserInteraction(){return new Promise(e=>{const t=["click","keydown","touchstart"];let s=!1;const n=()=>{s||(s=!0,t.forEach(i=>{document.removeEventListener(i,n)}),e())};t.forEach(i=>{document.addEventListener(i,n,{passive:!0})})})}}const st="_overlay_layer_lvcg2_1",nt="_row_lvcg2_16",at="_middle_lvcg2_21",it="_level_lvcg2_25",ot="_score_lvcg2_26",rt="_combo_lvcg2_34",lt="_bounce_lvcg2_40",x={overlay_layer:st,row:nt,middle:at,level:it,score:ot,combo:rt,bounce:lt};let ct=class{container;upper;middle;bottom;constructor(){this.container=document.createElement("div"),this.container.className=x.overlay_layer,this.upper=document.createElement("div"),this.upper.className=x.row,this.middle=document.createElement("div"),this.middle.className=x.middle;const e=document.createElement("div");this.bottom=document.createElement("div"),this.bottom.className=x.row,this.container.append(this.upper,this.middle,e,this.bottom)}get element(){return this.container}};class ut extends ct{loc;sound;player;constructor({handlePause:e,initialScore:t}){super(),this.loc=new I,this.sound=new V;const s=document.createElement("div"),n=document.createElement("span");this.loc.register("level",n);const i=document.createElement("span");s.className=x.level,i.innerText="1",s.append(n,": ",i);const o=document.createElement("div"),u=document.createElement("span");this.loc.register("score",u);const f=document.createElement("span");o.className=x.score,f.innerText=(t||0).toString(),o.append(u,": ",f);const p=document.createElement("div");p.className=x.combo,p.setAttribute("style","display: none;");const d=document.createElement("span");this.loc.register("combo",d);const g=document.createElement("span");g.innerText="x0",p.append(d,": ",g);const w=document.createElement("div");w.append(s,o,p),this.player={level:{el:s,value:i},score:{el:o,value:f},combo:{el:p,value:g}};const _=ae({src:this.sound.muted?m.soundOn:m.soundOff}),T=_.children[0];_.addEventListener("mousedown",F=>{F.stopPropagation(),this.handleSoundToggle(T)}),this.upper.append(w,_);const k=ae({src:m.pause});k.addEventListener("mousedown",F=>{F.stopPropagation(),e(!0)}),this.bottom.append(k)}handleLevel=e=>{this.player.level.value.innerText=(e+1).toString(),this.player.level.el.classList.add(x.bounce),setTimeout(()=>{this.player.level.el.classList.remove(x.bounce)},325)};handleScore=e=>{this.player.score.value.innerText=e.toString(),this.player.score.el.classList.add(x.bounce),setTimeout(()=>{this.player.score.el.classList.remove(x.bounce)},325)};handleCombo=e=>{this.player.combo.value.innerText=`x${e}`,e?(this.player.combo.el.setAttribute("style","display: block;"),this.player.combo.el.classList.add(x.bounce),setTimeout(()=>{this.player.combo.el.classList.remove(x.bounce)},325)):this.player.combo.el.setAttribute("style","display: none;")};handleTooltip=e=>{this.middle.innerText=e};handleSoundToggle=e=>{const t=this.sound.muted;this.sound.mute=!t,e.src=t?m.soundOff:m.soundOn}}class dt{key;constructor(){const e=[navigator.language||"en",navigator.userAgent.slice(navigator.userAgent.lastIndexOf(" ")+1)||"Chrome/141.0",(navigator.hardwareConcurrency||12).toString()];this.key=btoa(e.join("")).slice(0,16)}encrypt(e){return this.simpleObfuscate(e,this.key)}decrypt(e){return this.simpleDeobfuscate(e,this.key)}simpleObfuscate(e,t){const s=JSON.stringify(e);let n="";for(let i=0;i<s.length;i++)n+=String.fromCharCode(s.charCodeAt(i)^t.charCodeAt(i%16));return btoa(n)}simpleDeobfuscate(e,t){try{const s=atob(e);let n="";for(let i=0;i<s.length;i++)n+=String.fromCharCode(s.charCodeAt(i)^t.charCodeAt(i%16));return JSON.parse(n)}catch{return null}}}const ht={music:.5,sound:.5,fps:!1,language:navigator.language||"en",data:{score:0,caught:{butterfly:0,grasshopper:0,frog:0,mouse:0,bird:0}}};class $ extends dt{static _instance;static STORE_NAME="fastPaws";_state={...ht};constructor(){if(super(),$._instance)return $._instance;if($._instance=this,typeof localStorage<"u"){const e=localStorage.getItem($.STORE_NAME);if(e){let t={};try{t=JSON.parse(e)}catch{}const{data:s,...n}=t;if(this._state={...this._state,...n},s){const i=this.decrypt(s);i&&(this._state.data=i)}}}}getState(){return this._state}get(e){return this.getValue(e)}set(e,t){if(typeof t=="function"){const s=this.getValue(e);this.setValue(e,t(s))}else this.setValue(e,t);this.emit()}emit(){if(typeof globalThis.window<"u"){const e=this.encrypt(this._state.data),t=JSON.stringify({...this._state,data:e});localStorage.setItem($.STORE_NAME,t)}}setValue=(e,t)=>{let s=this._state;const n=e.split("."),i=n.pop();n.forEach(o=>{s[o]||(s[o]={}),s=s[o]}),i&&(s[i]=t)};getValue=e=>e.split(".").reduce((t,s)=>t&&t[s]!==void 0?t[s]:void 0,{...this._state})}const mt="_caught_wryco_1",pt="_spoil_wryco_6",ft="_bounce_wryco_19",ee={caught:mt,spoil:pt,bounce:ft},ue=["butterfly","grasshopper","mouse","bird"],gt=r=>ue.includes(r);class X{static _instance;storage;container;count={butterfly:0,grasshopper:0,frog:0,mouse:0,bird:0};slot={};constructor(){if(X._instance)return X._instance;X._instance=this,this.storage=new $;const e=this.storage.get("data.caught");e&&(this.count={...e}),this.container=document.createElement("div"),this.container.className=ee.caught;for(const t of ue){const{slot:s,icon:n,value:i}=this.createSlot(t);this.slot[t]={icon:n,value:i},this.container.append(s)}}setCount(e){this.count={...e}}handleUpdate=e=>{gt(e)&&(this.count[e]+=1,this.slot[e].value.innerText=this.count[e].toString(),this.storage.set(`data.caught.${e}`,this.count[e]),this.slot[e].icon.classList.add(ee.bounce),setTimeout(()=>{this.slot[e].icon.classList.remove(ee.bounce)},325))};handleReset=()=>{for(const e of ue)this.count[e]=0,this.slot[e].value.innerText="0";this.storage.set("data.caught",this.count)};createSlot=e=>{const t=document.createDocumentFragment(),s=document.createElement("span");s.className=ee.spoil;const n=document.createElement("img");n.src=ge[e],n.alt=e,s.append(n);const i=document.createElement("span");return i.innerText=this.count[e].toString(),t.append(s,i),{slot:t,icon:n,value:i}};get element(){return this.container}}async function bt(r){const e=r||document.documentElement,t=document;if(t.fullscreenEnabled||t.mozFullScreenEnabled||t.webkitFullscreenEnabled)try{e.requestFullscreen?await e.requestFullscreen():e.mozRequestFullScreen?await e.mozRequestFullScreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.msRequestFullscreen&&await e.msRequestFullscreen()}catch(n){console.error("Error activating fullscreen:",n)}}async function yt(){const r=document;r.exitFullscreen?await r.exitFullscreen():r.mozCancelFullScreen?await r.mozCancelFullScreen():r.webkitExitFullscreen&&await r.webkitExitFullscreen()}function _e(){const r=document;return!!(r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement)}async function _t(r,e=document.documentElement){r?await bt(e):_e()&&await yt()}const vt="_global_layer_1u9d7_1",wt="_row_upper_1u9d7_17",Et="_row_bottom_1u9d7_22",ce={global_layer:vt,row_upper:wt,row_bottom:Et};class Ct{container;upper;bottom;constructor(){this.container=document.createElement("div"),this.container.className=ce.global_layer,this.upper=document.createElement("div"),this.upper.className=ce.row_upper,this.bottom=document.createElement("div"),this.bottom.className=ce.row_bottom,this.container.append(this.upper,this.bottom)}get element(){return this.container}}class kt extends Ct{caught;constructor(){super(),this.caught=new X,this.upper.append(this.caught.element);const e=ae({src:m.fullscreen}),t=e.children[0];e.addEventListener("mousedown",s=>{s.stopPropagation(),this.handleFullscreenToggle(t)}),this.bottom.append(e)}handleFullscreenToggle=e=>{const t=_e(),s=document.querySelector("main");s&&(_t(!t,s),e.src=t?m.fullscreen:m.fullscreenExit)}}function St(){const r=document.createElement("a");return r.innerText="mrHoft",r.href="https://github.com/mrHoft",["Developed by ",r," in 2025."]}const Lt="_list_1rr9r_1",xt="_list__element_1rr9r_7",Tt="_flag_list_1rr9r_27",At="_flag_1rr9r_27",Nt="_selected_1rr9r_41",D={list:Lt,list__element:xt,flag_list:Tt,flag:At,selected:Nt},Ft=["music","sound","fps","language"];class Mt{storage;sound;loc;container;opt={};flags;constructor(){this.storage=new $,this.sound=new V,this.loc=new I,this.container=document.createElement("ul"),this.container.className=D.list;for(const i of Ft)this.opt[i]={el:document.createElement("li"),label:document.createElement("label"),input:document.createElement("input"),icon:document.createElement("img")},this.opt[i].label.append(this.opt[i].icon,this.opt[i].input),this.opt[i].el.append(this.opt[i].label);const e=Math.max(0,Math.min(this.storage.get("music"),1));this.opt.music.el.className=D.list__element,this.opt.music.label.setAttribute("label-for","music"),Object.assign(this.opt.music.input,{id:"music",type:"range",min:"0",max:"1",step:"0.1",defaultValue:e.toString()}),this.opt.music.icon.src=m.music,this.opt.music.input.addEventListener("change",i=>{const o=Number(i.currentTarget?.value);isFinite(o)&&(this.storage.set("music",o),this.sound.musicVolume=o,this.sound.play(0))});const t=Math.max(0,Math.min(this.storage.get("sound"),1));this.opt.sound.el.className=D.list__element,this.opt.sound.label.setAttribute("label-for","sound"),Object.assign(this.opt.sound.input,{id:"sound",type:"range",min:"0",max:"1",step:"0.1",defaultValue:t.toString()}),this.opt.sound.icon.src=m.sound,this.opt.sound.input.addEventListener("change",i=>{const o=Number(i.currentTarget?.value);isFinite(o)&&(this.storage.set("sound",o),this.sound.soundVolume=o,this.sound.use("catch"))});const s=this.storage.get("fps");this.opt.fps.el.className=D.list__element,this.opt.fps.label.setAttribute("label-for","fps"),Object.assign(this.opt.fps.input,{id:"fps",type:"checkbox",defaultChecked:s}),this.opt.fps.icon.src=m.fps,this.opt.fps.input.addEventListener("change",i=>{const{checked:o}=i.currentTarget;this.storage.set("fps",o)});const n=this.storage.get("language");this.opt.language.el.className=D.list__element,this.opt.fps.label.setAttribute("label-for","language"),this.opt.language.icon.src=m.globe,this.opt.sound.label.setAttribute("label-for","language"),this.opt.language.input.setAttribute("style","display: none;"),Object.assign(this.opt.language.input,{id:"language",defaultValue:n,style:"display: none;"}),this.flags=document.createElement("div"),this.flags.className=D.flag_list;for(const i of be){const o=document.createElement("img");o.className=D.flag,o.src=m[i],o.alt=i,i===this.opt.language.input.value&&o.classList.toggle(D.selected,!0),this.flags.append(o),o.addEventListener("pointerdown",this.handleFlagClick(i))}this.opt.language.label.append(this.flags),this.container.append(...Object.values(this.opt).map(i=>i.el))}handleFlagClick=e=>()=>{this.storage.set("language",e),this.loc.language=e,this.opt.language.input.value=e;const t=this.flags.children;for(const s of t)s.classList.toggle(D.selected,s.alt===e)};get element(){return this.container}}const Ot="_menu_layer_1w2ny_1",Pt="_menu_1w2ny_1",It="_level_1w2ny_57",Dt="_level__thumb_1w2ny_63",$t="_scene_1w2ny_76",Gt="_about_1w2ny_77",Rt="_settings_1w2ny_78",Vt="_scene__inner_1w2ny_90",jt="_scene__spoil_1w2ny_104",Bt="_about__inner_1w2ny_119",zt="_settings__inner_1w2ny_120",qt="_version_1w2ny_143",Ut="_bounce_1w2ny_156",v={menu_layer:Ot,menu:Pt,level:It,level__thumb:Dt,scene:$t,about:Gt,settings:Rt,scene__inner:Vt,scene__spoil:jt,about__inner:Bt,settings__inner:zt,version:qt,"top-right":"_top-right_1w2ny_150",bounce:Ut},ve="./thumb";class Ht{loc;container;menu;about;settings;thumbs=[];scene;constructor(){this.loc=new I,this.container=document.createElement("div"),this.container.className=v.menu_layer,this.container.setAttribute("style","display: none;");const e=document.createElement("div");e.className=v.level;const t=Math.floor(100/(R.length-1)*2);e.setAttribute("style",`height: ${100-t*.75}%;`);const s=Math.PI/2/(R.length-1);for(let P=R.length-1;P>=0;P-=1){const M=R[P],G=document.createElement("img");G.className=v.level__thumb,G.src=`${ve}/${M}.jpg`;const J=Math.PI*1-P*s,U=50+Math.floor(Math.cos(J)*50),Y=Math.floor(Math.sin(J)*100);G.setAttribute("style",`height: ${t}%; top: ${Y}%; left: ${U}%;`),this.thumbs.push({img:G,name:M}),e.append(G)}this.about=document.createElement("div"),this.about.className=v.about;const n=document.createElement("h3");this.loc.register("about",n);const i=document.createElement("div");i.className=v.about__inner;const o=te();o.addEventListener("click",()=>{this.about.setAttribute("style","display: none;")}),i.append(n,...St(),o),this.about.append(i),this.settings=document.createElement("div"),this.settings.className=v.settings;const u=document.createElement("h3");this.loc.register("settings",u);const f=document.createElement("div"),p=te();p.addEventListener("click",()=>{this.settings.setAttribute("style","display: none;")}),f.className=v.settings__inner,f.append(u,new Mt().element,p),this.settings.append(f);const d=document.createElement("div");d.className=v.scene;const g=document.createElement("div");g.className=v.scene__inner;const w=te();w.addEventListener("click",()=>{this.scene.element.setAttribute("style","display: none;")});const _=q({src:m.play}),T={},k=document.createElement("div");k.className=v.scene__spoil,ne.forEach(P=>{const M=document.createElement("img");M.src=ge[P],M.alt=P,M.width=M.height=40,k.append(M),T[P]=M}),g.append(_,k,w),d.append(g),this.scene={element:d,inner:g,btn:_,spoil:T,name:"default"};const F=document.createElement("div");F.className=v.version,F.innerText=Pe.version,this.menu=document.createElement("div"),this.menu.className=v.menu,this.container.append(F,e,this.menu,d,this.about,this.settings)}menuInit(e){for(const t of e){const s=document.createElement("button"),n=document.createElement("img");n.src=t.icon,n.alt=t.id;const i=document.createElement("span");this.loc.register(t.id,i),s.append(n,i),s.onclick=t.func,this.menu.append(s)}}show=(e=!0)=>{this.container.setAttribute("style",`display: ${e?"block":"none"};`)};get element(){return this.container}}class Wt extends Ht{startGame;confirm;constructor({start:e,confirm:t}){super(),this.startGame=e,this.confirm=t,this.thumbs.forEach(i=>{i.img.addEventListener("click",this.handleSceneClick(i.name))}),this.scene.btn.addEventListener("click",()=>{this.scene.element.setAttribute("style","display: none;"),this.startGame(this.scene.name)}),this.scene.element.addEventListener("click",this.handleOutsideClick),this.about.addEventListener("click",this.handleOutsideClick),this.settings.addEventListener("click",this.handleOutsideClick);const s=[{id:"start",icon:m.play,func:this.handleStart},{id:"restart",icon:m.restart,func:this.handleRestart},{id:"settings",icon:m.settings,func:this.handleSettings}];this.menuInit(s);const n=ae({src:m.about});n.classList.add(v["top-right"]),n.addEventListener("click",this.handleAbout),this.container.append(n)}handleOutsideClick=e=>{const{target:t,currentTarget:s}=e;if(s&&t===s){e.preventDefault();const n=s;n.setAttribute("style","display: none;");for(const i of n.children)i.classList.remove(v.bounce)}};handleStart=()=>{const e=R[Math.floor(Math.random()*R.length)];this.handleSceneClick(e)()};handleRestart=()=>{this.confirm.show({text:this.loc.get("restartDesc"),acceptCallback:()=>this.startGame(R[0],!0)})};handleAbout=()=>{this.about.setAttribute("style","display: flex;"),this.about.firstElementChild?.classList.add(v.bounce)};handleSettings=()=>{this.settings.setAttribute("style","display: flex;"),this.settings.firstElementChild?.classList.add(v.bounce)};handleSceneClick=e=>t=>{if(t){const n=t.currentTarget;n.style.pointerEvents="none",n.offsetHeight,setTimeout(()=>{n.style.pointerEvents=""},0)}this.scene.name=e,this.scene.element.setAttribute("style","display: flex;"),this.scene.inner.setAttribute("style",`background-image: url(${ve}/${e}.jpg)`),this.scene.inner.classList.add(v.bounce);const s=De[e].filter(n=>ne.includes(n));for(const n of ne){const i=this.scene.spoil[n];if(i){const o=s.includes(i.alt);i.setAttribute("style",`display: ${o?"block":"none"}`)}}}}class Kt{root;game;loader;loaderBar;loaderValue;message;errors=[];constructor(){const e=document.querySelector("#app");if(e){this.root=e;const t=document.createElement("main");t.className="main",this.game=document.createElement("div"),this.game.className="game",t.append(this.game),this.root.append(t)}else throw new Error("Root element not found")}loaderInit(){this.loader=document.createElement("div"),this.loader.classList.add("loader_layer");const e=document.createElement("div");e.classList.add("loader"),this.loaderBar=document.createElement("div"),this.loaderBar.classList.add("loader__bar"),this.loaderValue=document.createElement("div"),this.loaderValue.classList.add("loader__value"),e.append(this.loaderBar,this.loaderValue),this.loader.append(e),this.message=document.createElement("div"),this.message.classList.add("loader__message"),this.game.append(this.loader,this.message)}loaderRemove(){this.loader&&this.loader.remove(),this.message&&(this.errors.length||this.message.remove())}loaderUpdate(e){this.loaderValue&&this.loaderBar&&(this.loaderValue.innerText=`${e}%`,this.loaderBar.setAttribute("style",`width: ${e}%;`))}}class Xt extends Kt{loading={start:0};pause;confirm;overlay;weather;menu;ui;storage;engineStart;constructor(){super(),this.storage=new $,new I(this.storage.get("language"));const e=Math.max(0,Math.min(this.storage.get("music"),1)),t={volume:e,muted:e===0},s=Math.max(0,Math.min(this.storage.get("music"),1)),n={volume:s,muted:s===0};new V({music:t,sound:n}),this.confirm=new Je,this.menu=new Wt({start:this.startGame,confirm:this.confirm}),this.ui=new kt,this.game.append(this.menu.element,this.ui.element,this.confirm.element)}init=async()=>{this.loaderInit(),this.game.addEventListener("contextmenu",s=>(s.preventDefault(),!1)),this.loading.start=Date.now();const e=s=>{this.loaderUpdate(s),s===100&&(console.log(`\x1B[33m${t.total}\x1B[0m assets loaded in \x1B[33m${Date.now()-this.loading.start}ms\x1B[0m`),this.handleLoadComplete())},t=C.get(e,this.onError({source:"assets"}))};handleLoadComplete=()=>{this.loaderRemove(),!this.errors.length&&this.menu.show()};initGame=async()=>{const e=document.createElement("canvas");e.width=z.width,e.height=z.height,e.className="game_layer",e.setAttribute("style","z-index: 1");const{Engine:t}=await Ne(async()=>{const{Engine:o}=await import("./engine-CDwbBqLo.js");return{Engine:o}},[],import.meta.url),s={handlePause:this.handlePause,handleGameOver:()=>console.log("Handle game over"),setLevel:o=>this.overlay?.handleLevel(o),setCombo:o=>this.overlay?.handleCombo(o),updateScore:this.handleUpdateScore,updateCaught:o=>this.ui?.caught.handleUpdate(o),resetCaught:()=>this.ui?.caught.handleReset(),showTooltip:o=>this.overlay?.handleTooltip(o)},n=this.storage.get("data.score"),i=t.get({ctx:e.getContext("2d"),handlers:s,initialScore:n});this.overlay=new ut({handlePause:i.pause,initialScore:n}),this.weather=new Ve,this.pause=new tt({pause:o=>{i.pause(o),this.weather?.pause(o)},restart:()=>{i.start({restart:!0}),this.weather?.pause(!1)},menu:()=>{i.stop(),this.menu.show()},confirm:this.confirm}),this.game.append(e,this.overlay.element,this.weather.element,this.pause.element),this.engineStart=(o="default",u)=>i.start({sceneName:o,fps:u?.fps,restart:u?.restart})};startGame=(e,t)=>{this.menu.show(!1),this.weather?.pause(!1);const s={fps:this.storage.get("fps"),restart:t};this.engineStart?this.engineStart(e,s):this.initGame().then(()=>this.engineStart(e,s))};handlePause=e=>{this.pause?.show(e),this.weather?.pause(e)};handleUpdateScore=e=>{this.overlay?.handleScore(e),this.storage.set("data.score",e)};onError=({source:e})=>t=>{const s=Date.now()-this.loading.start;if(this.errors.push({source:e,message:t,lapse:s}),console.error(t,`(${s}ms)`),this.message){const n=document.createElement("div");n.innerText=t,this.message.appendChild(n)}}}new Xt().init();export{ne as A,Ie as B,z as C,Pe as G,I as L,C as R,re as S,Yt as T,V as a,De as b,Jt as g};
